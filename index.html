<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HiszpaÅ„ski: Kolokwium</title>
    
    <!-- Konfiguracja Ikon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ‡ªðŸ‡¸</text></svg>">
    <link rel="apple-touch-icon" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/es.svg">
    <meta name="theme-color" content="#030712">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM via ESM -->
    <script type="importmap">
      {
        "imports": {
          "react": "https://esm.sh/react@18.2.0",
          "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
          "lucide-react": "https://esm.sh/lucide-react@0.263.1"
        }
      }
    </script>
    
    <style>
        body { background-color: #030712; color: #e5e7eb; font-family: sans-serif; -webkit-tap-highlight-color: transparent; }
        .perspective-1000 { perspective: 1000px; }
        .preserve-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            ArrowLeft, Shuffle, RotateCcw, Layers, Check, X, 
            MessageCircle, Heart, Briefcase, Hotel, 
            Play, Trophy, Star, Eye, EyeOff, Repeat, Keyboard, ArrowLeftRight,
            Loader2, Sparkles, Volume2, ListChecks, Lightbulb
        } from 'lucide-react';

        // --- POMOCNICZA FUNKCJA DO TASOWANIA ---
        const shuffleArray = (array) => {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        };

        // --- BAZA DANYCH ---
        const FLASHCARDS_DATA = [
            // a) TIEMPO LIBRE
            { id: 1, front: "El garaje", back: "GaraÅ¼", category: "Tiempo libre" },
            { id: 2, front: "El minibar", back: "Minibar", category: "Tiempo libre" },
            { id: 3, front: "El gimnasio", back: "SiÅ‚ownia", category: "Tiempo libre" },
            { id: 4, front: "La piscina", back: "Basen", category: "Tiempo libre" },
            { id: 5, front: "El spa", back: "Spa", category: "Tiempo libre" },
            { id: 6, front: "El campo de golf", back: "Pole golfowe", category: "Tiempo libre" },
            { id: 7, front: "La calefacciÃ³n / El aire acondicionado", back: "Klimatyzacja (i ogrzewanie)", category: "Tiempo libre" },
            { id: 8, front: "Internet / Wifi", back: "Internet", category: "Tiempo libre" },
            { id: 9, front: "TelevisiÃ³n vÃ­a satÃ©lite", back: "Telewizja satelitarna", category: "Tiempo libre" },
            { id: 10, front: "Sala de reuniones", back: "Sala konferencyjna", category: "Tiempo libre" },
            { id: 11, front: "Hablar con", back: "RozmawiaÄ‡ z", category: "Tiempo libre" },
            { id: 12, front: "Descansar", back: "OdpoczywaÄ‡", category: "Tiempo libre" },
            { id: 13, front: "Ir a lugar tranquilo", back: "IÅ›Ä‡ w spokojne miejsce", category: "Tiempo libre" },
            { id: 14, front: "Estar en la naturaleza", back: "ByÄ‡ na Å‚onie natury", category: "Tiempo libre" },
            { id: 15, front: "Decir", back: "MÃ³wiÄ‡", category: "Tiempo libre" },
            { id: 16, front: "Poner", back: "WÅ‚Ä…czaÄ‡ (teÅ¼: kÅ‚aÅ›Ä‡)", category: "Tiempo libre" },
            { id: 17, front: "Venir", back: "PrzychodziÄ‡", category: "Tiempo libre" },
            { id: 18, front: "Salir", back: "WychodziÄ‡", category: "Tiempo libre" },
            { id: 19, front: "Coleccionar sellos", back: "ZbieraÄ‡ znaczki", category: "Tiempo libre" },
            { id: 20, front: "Encontrarse (con)", back: "SpotkaÄ‡ siÄ™ (z)", category: "Tiempo libre" },
            { id: 21, front: "Esquiar", back: "JeÅºdziÄ‡ na nartach", category: "Tiempo libre" },
            { id: 22, front: "Hacer deporte", back: "UprawiaÄ‡ sport", category: "Tiempo libre" },
            { id: 23, front: "Hacer excursiones", back: "RobiÄ‡ wycieczki", category: "Tiempo libre" },
            { id: 24, front: "Hacer footing", back: "Jogging / BiegaÄ‡", category: "Tiempo libre" },
            { id: 25, front: "Hacer fotos", back: "RobiÄ‡ zdjÄ™cia", category: "Tiempo libre" },
            { id: 26, front: "Hacer gimnasia", back: "GimnastykowaÄ‡ siÄ™", category: "Tiempo libre" },
            { id: 27, front: "Hacer senderismo", back: "UprawiaÄ‡ turystykÄ™ pieszÄ…", category: "Tiempo libre" },
            { id: 28, front: "Hacer snorkeling", back: "NurkowaÄ‡ z rurkÄ…", category: "Tiempo libre" },
            { id: 29, front: "Hacer surf", back: "SurfowaÄ‡", category: "Tiempo libre" },
            { id: 30, front: "Hacer trabajos de bricolaje", back: "MajsterkowaÄ‡", category: "Tiempo libre" },
            { id: 31, front: "Hacer trabajos manuales", back: "WykonywaÄ‡ prace rÄ™czne", category: "Tiempo libre" },
            { id: 32, front: "Hacer yoga", back: "UprawiaÄ‡ jogÄ™", category: "Tiempo libre" },
            { id: 33, front: "Ir a comer", back: "ZjeÅ›Ä‡ / IÅ›Ä‡ na obiad", category: "Tiempo libre" },
            { id: 34, front: "Ir al cine", back: "IÅ›Ä‡ do kina", category: "Tiempo libre" },
            { id: 35, front: "Ir al gimnasio", back: "IÅ›Ä‡ na siÅ‚owniÄ™", category: "Tiempo libre" },
            { id: 36, front: "Ir en bicicleta", back: "JeÅºdziÄ‡ na rowerze", category: "Tiempo libre" },
            { id: 37, front: "Ir en canoa", back: "PÅ‚ywaÄ‡ kajakiem", category: "Tiempo libre" },
            { id: 38, front: "Jugar a las cartas", back: "GraÄ‡ w karty", category: "Tiempo libre" },
            { id: 39, front: "Jugar al ajedrez", back: "GraÄ‡ w szachy", category: "Tiempo libre" },
            { id: 40, front: "Jugar al baloncesto", back: "GraÄ‡ w koszykÃ³wkÄ™", category: "Tiempo libre" },
            { id: 41, front: "Jugar al balonmano", back: "GraÄ‡ w piÅ‚kÄ™ rÄ™cznÄ…", category: "Tiempo libre" },
            { id: 42, front: "Jugar al fÃºtbol", back: "GraÄ‡ w piÅ‚kÄ™ noÅ¼nÄ…", category: "Tiempo libre" },
            { id: 43, front: "Jugar al golf", back: "GraÄ‡ w golfa", category: "Tiempo libre" },
            { id: 44, front: "Jugar al ordenador", back: "GraÄ‡ na komputerze", category: "Tiempo libre" },
            { id: 45, front: "Jugar al tenis", back: "GraÄ‡ w tenisa", category: "Tiempo libre" },
            { id: 46, front: "Jugar al voleibol", back: "GraÄ‡ w siatkÃ³wkÄ™", category: "Tiempo libre" },
            { id: 47, front: "Leer", back: "CzytaÄ‡", category: "Tiempo libre" },
            { id: 48, front: "Montar a caballo", back: "JeÅºdziÄ‡ konno", category: "Tiempo libre" },
            { id: 49, front: "Nadar", back: "PÅ‚ywaÄ‡", category: "Tiempo libre" },
            { id: 50, front: "Navegar", back: "Å»eglowaÄ‡", category: "Tiempo libre" },
            { id: 51, front: "Navegar por internet", back: "SurfowaÄ‡ po internecie", category: "Tiempo libre" },
            { id: 52, front: "Pasear", back: "SpacerowaÄ‡", category: "Tiempo libre" },
            { id: 53, front: "Patinar", back: "JeÅºdziÄ‡ na Å‚yÅ¼wach/rolkach", category: "Tiempo libre" },
            { id: 54, front: "Quedar (con)", back: "UmÃ³wiÄ‡ siÄ™ (z)", category: "Tiempo libre" },
            { id: 55, front: "Tocar el piano", back: "GraÄ‡ na pianinie", category: "Tiempo libre" },
            { id: 56, front: "Tocar la guitarra", back: "GraÄ‡ na gitarze", category: "Tiempo libre" },
            { id: 57, front: "Ver la televisiÃ³n", back: "OglÄ…daÄ‡ telewizjÄ™", category: "Tiempo libre" },
            { id: 58, front: "Viajar", back: "PodrÃ³Å¼owaÄ‡", category: "Tiempo libre" },
            { id: 59, front: "Visitar", back: "OdwiedzaÄ‡, zwiedzaÄ‡", category: "Tiempo libre" },

            // b) RESERVA
            { id: 60, front: "Â¿En quÃ© puedo ayudarle?", back: "W czym mogÄ™ pomÃ³c?", category: "Reserva" },
            { id: 61, front: "Â¿Para quÃ© fechas?", back: "Na jakie daty?", category: "Reserva" },
            { id: 62, front: "Â¿Para cuÃ¡ntas personas?", back: "Dla ilu osÃ³b?", category: "Reserva" },
            { id: 63, front: "QuerÃ­a reservar 6 habitaciones", back: "ChciaÅ‚bym zarezerwowaÄ‡ 6 pokoi", category: "Reserva" },
            { id: 64, front: "Para tres noches", back: "Na trzy noce", category: "Reserva" },
            { id: 65, front: "Del 20 al 23 de mayo", back: "Od 20 do 23 maja", category: "Reserva" },
            { id: 66, front: "Para 17 personas", back: "Dla 17 osÃ³b", category: "Reserva" },
            { id: 67, front: "Â¿Me puede decir si tienen...?", back: "Czy moÅ¼e mi Pan powiedzieÄ‡, czy macie...?", category: "Reserva" },
            { id: 68, front: "Â¿EstÃ¡ incluido en el precio?", back: "Czy to jest wliczone w cenÄ™?", category: "Reserva" },
            { id: 69, front: "SÃ­, y ademÃ¡s ofrecemos...", back: "Tak, a ponadto oferujemy...", category: "Reserva" },
            { id: 70, front: "No, lo siento", back: "Nie, przykro mi", category: "Reserva" },
            { id: 71, front: "Doble / Individual", back: "Dwuosobowy / Jednoosobowy", category: "Reserva" },
            { id: 72, front: "Exterior / Interior", back: "ZewnÄ™trzny / WewnÄ™trzny", category: "Reserva" },
            { id: 73, front: "Tranquila / Ruidosa", back: "Spokojny / HaÅ‚aÅ›liwy", category: "Reserva" },
            { id: 74, front: "Con ducha / baÃ±o", back: "Z prysznicem / z wannÄ…", category: "Reserva" },
            { id: 75, front: "Con televisiÃ³n / Internet", back: "Z telewizorem / Internetem", category: "Reserva" },
            { id: 76, front: "Sala con proyector", back: "Sala z rzutnikiem", category: "Reserva" },
            { id: 77, front: "Todas las salas disponen de Internet", back: "Wszystkie sale dysponujÄ… Internetem", category: "Reserva" },
            { id: 78, front: "Â¿El catering estÃ¡ incluido?", back: "Czy catering jest wliczony?", category: "Reserva" },
            { id: 79, front: "Le puedo enviar algunas ofertas", back: "MogÄ™ Panu przesÅ‚aÄ‡ kilka ofert", category: "Reserva" },
            { id: 80, front: "Perfecto, muchas gracias", back: "Idealnie, dziÄ™kujÄ™ bardzo", category: "Reserva" },

            // c) PROBLEMAS
            { id: 81, front: "Tenemos un problema con...", back: "Mamy problem z...", category: "Problemas" },
            { id: 82, front: "En la habitaciÃ³n faltan toallas", back: "W pokoju brakuje rÄ™cznikÃ³w", category: "Problemas" },
            { id: 83, front: "No hay toallas", back: "Nie ma rÄ™cznikÃ³w", category: "Problemas" },
            { id: 84, front: "La habitaciÃ³n no estÃ¡ limpia", back: "PokÃ³j nie jest czysty", category: "Problemas" },
            { id: 85, front: "Mire, es que no funciona la ducha", back: "ProszÄ™ spojrzeÄ‡, nie dziaÅ‚a prysznic", category: "Problemas" },
            { id: 86, front: "No funciona el aire acondicionado", back: "Nie dziaÅ‚a klimatyzacja", category: "Problemas" },
            { id: 87, front: "Hay mucho ruido", back: "Jest duÅ¼y haÅ‚as", category: "Problemas" },
            { id: 88, front: "No podemos oÃ­r nada", back: "Nic nie sÅ‚yszymy", category: "Problemas" },
            { id: 89, front: "La comida es mala", back: "Jedzenie jest niedobre", category: "Problemas" },
            { id: 90, front: "AquÃ­ no se puede trabajar", back: "Tutaj nie da siÄ™ pracowaÄ‡", category: "Problemas" },
            { id: 91, front: "No podemos proyectar la presentaciÃ³n", back: "Nie moÅ¼emy wyÅ›wietliÄ‡ prezentacji", category: "Problemas" },
            { id: 92, front: "Â¡CuÃ¡nto lo siento!", back: "Bardzo przepraszam!", category: "Problemas" },
            { id: 93, front: "PerdÃ³n por las molestias", back: "Przepraszam za kÅ‚opoty", category: "Problemas" },
            { id: 94, front: "Disculpe", back: "Przepraszam (oficjalnie)", category: "Problemas" },
            { id: 95, front: "Enseguida le mando al tÃ©cnico", back: "Zaraz przyÅ›lÄ™ technika", category: "Problemas" },
            { id: 96, front: "Ahora mismo le mando al personal de limpieza", back: "Zaraz przyÅ›lÄ™ personel sprzÄ…tajÄ…cy", category: "Problemas" },
            { id: 97, front: "Podemos ofrecerle otro/-a...", back: "MoÅ¼emy zaoferowaÄ‡ Panu inny...", category: "Problemas" },
            { id: 98, front: "Si lo desean", back: "JeÅ›li PaÅ„stwo sobie Å¼yczÄ…", category: "Problemas" },

            // --- KINO (Z MATERIAÅÃ“W) ---
            { id: 301, front: "La pelÃ­cula de acciÃ³n", back: "Film akcji", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 302, front: "La pelÃ­cula romÃ¡ntica", back: "Film romantyczny", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 303, front: "La pelÃ­cula del oeste", back: "Western", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 304, front: "La pelÃ­cula de terror", back: "Horror", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 305, front: "La pelÃ­cula de suspense", back: "Thriller", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 306, front: "La pelÃ­cula de comedia", back: "Komedia", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 307, front: "La pelÃ­cula de ciencia ficciÃ³n", back: "Film science-fiction", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 308, front: "La pelÃ­cula de aventuras", back: "Film przygodowy", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 309, front: "La pelÃ­cula de dibujos animados", back: "Film animowany", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 310, front: "PelÃ­cula basada en hechos reales", back: "Film oparty na faktach", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 311, front: "El documental", back: "Dokument", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 312, front: "El musical", back: "Musical", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 313, front: "El cine", back: "Kino", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 314, front: "La entrada", back: "Bilet", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 315, front: "La taquilla", back: "Kasa biletowa", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 316, front: "Las palomitas", back: "Popcorn", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 317, front: "El proyector", back: "Projektor", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 318, front: "La pantalla", back: "Ekran", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 319, front: "La sala de cine", back: "Sala kinowa", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 320, front: "La butaca / El asiento", back: "Fotel / Siedzenie", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 321, front: "La fila", back: "RzÄ…d", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 322, front: "El actor", back: "Aktor", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 323, front: "La actriz", back: "Aktorka", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 324, front: "El director", back: "ReÅ¼yser", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 325, front: "El guionista", back: "Scenarzysta", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 326, front: "El espectador", back: "Widz", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 327, front: "Hacer la cola", back: "StaÄ‡ w kolejce", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 328, front: "La sesiÃ³n", back: "Seans", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 329, front: "La cartelera", back: "Repertuar / Plakat", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 330, front: "La claqueta", back: "Klaps filmowy", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 331, front: "La banda sonora", back: "ÅšcieÅ¼ka dÅºwiÄ™kowa", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 332, front: "La sinopsis", back: "Streszczenie", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 333, front: "Los estrenos", back: "Premiery", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 334, front: "Rodar", back: "KrÄ™ciÄ‡ (film)", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 335, front: "Proyectar", back: "WyÅ›wietlaÄ‡", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 336, front: "La trama", back: "FabuÅ‚a", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 337, front: "El gÃ©nero", back: "Gatunek", category: "Kino (Z materiaÅ‚Ã³w)" },
            { id: 338, front: "El guion", back: "Scenariusz", category: "Kino (Z materiaÅ‚Ã³w)" },

            // --- KOLOKACJE ---
            { id: 300, front: "Reservar una mesa", back: "ZarezerwowaÄ‡ stolik", category: "Kolokacje" },
            { id: 3010, front: "Hacer una reserva", back: "DokonaÄ‡ rezerwacji", category: "Kolokacje" },
            { id: 3020, front: "Pedir la cuenta", back: "PoprosiÄ‡ o rachunek", category: "Kolokacje" },
            { id: 3030, front: "Salir de noche", back: "WychodziÄ‡ wieczorem", category: "Kolokacje" },
            { id: 3040, front: "Pedir informaciÃ³n", back: "PytaÄ‡ o informacjÄ™", category: "Kolokacje" },
            { id: 3050, front: "Hacer deporte", back: "UprawiaÄ‡ sport", category: "Kolokacje" },
            { id: 3060, front: "Salir con amigos", back: "WychodziÄ‡ z przyjaciÃ³Å‚mi", category: "Kolokacje" },
            { id: 3070, front: "Reservar una habitaciÃ³n", back: "ZarezerwowaÄ‡ pokÃ³j", category: "Kolokacje" },
            { id: 3080, front: "Hacer la maleta", back: "PakowaÄ‡ walizkÄ™", category: "Kolokacje" },
            { id: 3090, front: "Hacer una foto", back: "ZrobiÄ‡ zdjÄ™cie", category: "Kolokacje" },
            { id: 3100, front: "Salir de copas", back: "IÅ›Ä‡ na drinka", category: "Kolokacje" },
            { id: 3110, front: "Pedir el desayuno", back: "ZamÃ³wiÄ‡ Å›niadanie", category: "Kolokacje" },
            { id: 3120, front: "Reservar un billete", back: "ZarezerwowaÄ‡ bilet", category: "Kolokacje" },
        ];

        // --- QUIZ DATA ---
        const QUIZ_AGREEMENT_DATA_FULL = [
            { q: "Me gusta el fÃºtbol. (+)", options: ["A mÃ­ tambiÃ©n", "A mÃ­ no", "Yo tambiÃ©n"], correct: "A mÃ­ tambiÃ©n", type: "gustar" },
            { q: "No me interesa la polÃ­tica. (-)", options: ["A mÃ­ tampoco", "A mÃ­ sÃ­", "Yo tampoco"], correct: "A mÃ­ tampoco", type: "gustar" },
            { q: "Tengo hambre. (+)", options: ["Yo tambiÃ©n", "A mÃ­ tambiÃ©n", "Yo no"], correct: "Yo tambiÃ©n", type: "normal" },
            { q: "No soy francÃ©s. (-)", options: ["Yo tampoco", "A mÃ­ tampoco", "Yo sÃ­"], correct: "Yo tampoco", type: "normal" },
            { q: "Me encanta viajar. (+)", options: ["A mÃ­ tambiÃ©n", "Yo tambiÃ©n", "A mÃ­ sÃ­"], correct: "A mÃ­ tambiÃ©n", type: "gustar" },
            { q: "No trabajo los domingos. (-)", options: ["Yo tampoco", "A mÃ­ tampoco", "Yo no"], correct: "Yo tampoco", type: "normal" },
            { q: "Me gusta mucho leer. (-)", options: ["A mÃ­ no", "A mÃ­ tampoco", "Yo no"], correct: "A mÃ­ no", type: "gustar_disagree" },
            { q: "No me gusta el golf. (+)", options: ["A mÃ­ sÃ­", "A mÃ­ tambiÃ©n", "Yo sÃ­"], correct: "A mÃ­ sÃ­", type: "gustar_disagree" },
            { q: "Vivo en Madrid. (+)", options: ["Yo tambiÃ©n", "A mÃ­ tambiÃ©n", "Yo no"], correct: "Yo tambiÃ©n", type: "normal" },
            { q: "Hablo inglÃ©s. (+)", options: ["Yo tambiÃ©n", "A mÃ­ tambiÃ©n", "Yo sÃ­"], correct: "Yo tambiÃ©n", type: "normal" },
            { q: "Soy estudiante. (+)", options: ["Yo tambiÃ©n", "A mÃ­ tambiÃ©n", "A mÃ­ no"], correct: "Yo tambiÃ©n", type: "normal" },
            { q: "Trabajo en un banco. (+)", options: ["Yo tambiÃ©n", "Yo no", "A mÃ­ tambiÃ©n"], correct: "Yo tambiÃ©n", type: "normal" },
            { q: "No tengo coche. (-)", options: ["Yo tampoco", "A mÃ­ tampoco", "Yo sÃ­"], correct: "Yo tampoco", type: "normal" },
            { q: "No vivo aquÃ­. (-)", options: ["Yo tampoco", "Yo no", "A mÃ­ tampoco"], correct: "Yo tampoco", type: "normal" },
            { q: "Estudio mucho. (-)", options: ["Yo no", "Yo tampoco", "A mÃ­ no"], correct: "Yo no", type: "normal_disagree" },
            { q: "No como carne. (+)", options: ["Yo sÃ­", "Yo tambiÃ©n", "A mÃ­ sÃ­"], correct: "Yo sÃ­", type: "normal_disagree" }
        ];

        const QUIZ_GUSTAR_DATA_FULL = [
            { q: "(Ja) A mÃ­ ___ gusta el cine.", options: ["me", "te", "le"], correct: "me" },
            { q: "(Ty) Â¿A ti ___ gusta el fÃºtbol?", options: ["te", "le", "me"], correct: "te" },
            { q: "A Juan (on) ___ gusta leer.", options: ["le", "se", "te"], correct: "le" },
            { q: "A MarÃ­a (ona) ___ encanta la mÃºsica.", options: ["le", "la", "se"], correct: "le" },
            { q: "(My) A nosotros ___ encanta viajar.", options: ["nos", "os", "les"], correct: "nos" },
            { q: "(Wy) A vosotros ___ interesa el arte.", options: ["os", "les", "nos"], correct: "os" },
            { q: "(Oni) A ellos ___ gustan los perros.", options: ["les", "los", "se"], correct: "les" },
            { q: "A mis padres ___ gusta cocinar.", options: ["les", "le", "su"], correct: "les" },
            { q: "Me _______ escuchar mÃºsica.", options: ["gusta", "gustan", "gusto"], correct: "gusta" },
            { q: "Te _______ mucho el fÃºtbol.", options: ["interesa", "interesan", "intereso"], correct: "interesa" },
            { q: "Nos _______ este libro.", options: ["gusta", "gustan", "gustamos"], correct: "gusta" },
            { q: "Le _______ la playa.", options: ["encanta", "encantan", "encante"], correct: "encanta" },
            { q: "A mÃ­ no me _______ el cafÃ©.", options: ["gusta", "gustan", "gusto"], correct: "gusta" },
            { q: "Me _______ las pelÃ­culas de terror.", options: ["gustan", "gusta", "gustas"], correct: "gustan" },
            { q: "Nos _______ los videojuegos.", options: ["encantan", "encanta", "encantamos"], correct: "encantan" },
            { q: "A ellos les _______ los museos.", options: ["interesan", "interesa", "interesamos"], correct: "interesan" },
            { q: "Â¿Te _______ tus profesores?", options: ["gustan", "gusta", "gustas"], correct: "gustan" },
            { q: "No me _______ las matemÃ¡ticas.", options: ["gustan", "gusta", "gusto"], correct: "gustan" },
            { q: "Me _______ la cabeza. (Doler)", options: ["duele", "duelen", "duelo"], correct: "duele" },
            { q: "Me _______ los pies. (Doler)", options: ["duelen", "duele", "duelas"], correct: "duelen" },
            { q: "No me _______ el dinero. (Importar)", options: ["importa", "importan", "importo"], correct: "importa" }
        ];

        const QUIZ_COLLOCATIONS_DATA = [
            { q: "Quiero _______ una mesa para dos.", options: ["hacer", "reservar", "salir"], correct: "reservar" },
            { q: "Voy a _______ la maleta ahora.", options: ["hacer", "tener", "pedir"], correct: "hacer" },
            { q: "Camarero, quiero _______ la cuenta.", options: ["pedir", "hacer", "reservar"], correct: "pedir" },
            { q: "Me gusta _______ deporte.", options: ["hacer", "jugar", "ir"], correct: "hacer" },
            { q: "Vamos a _______ de copas esta noche.", options: ["salir", "andar", "pasear"], correct: "salir" },
            { q: "Tengo que _______ una foto.", options: ["hacer", "reservar", "pedir"], correct: "hacer" },
            { q: "Quiero _______ informaciÃ³n sobre el hotel.", options: ["pedir", "reservar", "salir"], correct: "pedir" },
            { q: "Â¿Podemos _______ un billete de aviÃ³n?", options: ["reservar", "hacer", "salir"], correct: "reservar" },
            { q: "MaÃ±ana voy a _______ turismo por la ciudad.", options: ["hacer", "salir", "pedir"], correct: "hacer" },
            { q: "Â¿Te gusta _______ al fÃºtbol?", options: ["jugar", "hacer", "tocar"], correct: "jugar" },
            { q: "Voy a _______ el desayuno a la habitaciÃ³n.", options: ["pedir", "reservar", "salir"], correct: "pedir" },
        ];

        const HOTEL_SCENARIOS = [
            { 
                context: "Klient chce zarezerwowaÄ‡ pokÃ³j na dwie osoby.",
                receptionist: "Â¿Individual o doble?",
                options: ["Doble, por favor.", "Individual, gracias.", "Una mesa para dos."],
                correct: "Doble, por favor."
            },
            { 
                context: "ZgÅ‚aszasz problem: W pokoju jest brudno.",
                client: "Oiga, la habitaciÃ³n...",
                options: ["no funciona.", "estÃ¡ sucia.", "no hay toallas."],
                correct: "estÃ¡ sucia."
            },
            { 
                context: "Recepcjonista pyta o wyÅ¼ywienie.",
                receptionist: "Â¿Con desayuno incluido?",
                options: ["SÃ­, Â¿cuÃ¡nto cuesta?", "SÃ­, quiero una reserva.", "No, no funciona."],
                correct: "SÃ­, Â¿cuÃ¡nto cuesta?"
            },
            { 
                context: "ZgÅ‚aszasz problem: Klimatyzacja nie dziaÅ‚a.",
                client: "Mire, es que el aire acondicionado...",
                options: ["estÃ¡ sucio.", "no hay.", "no funciona."],
                correct: "no funciona."
            },
            { 
                context: "Recepcjonista reaguje na problem.",
                receptionist: "Lo siento mucho.",
                options: ["Ahora mismo sube el servicio tÃ©cnico.", "Gracias, adiÃ³s.", "Quiero reservar."],
                correct: "Ahora mismo sube el servicio tÃ©cnico."
            },
            { 
                context: "ZgÅ‚aszasz problem: Nie ma ciepÅ‚ej wody.",
                client: "Perdone, en mi habitaciÃ³n...",
                options: ["no hay agua caliente.", "falta la luz.", "hay mucho ruido."],
                correct: "no hay agua caliente."
            },
        ];

        const specialChars = ['Ã¡', 'Ã©', 'Ã­', 'Ã±', 'Ã³', 'Ãº', 'Ã¼', 'Â¿', 'Â¡'];

        // --- KOMPONENTY ---

        const Flashcards = ({ onBack, learnedCards, onMarkLearned, onViewLearned, onUnlearn }) => {
            const [deck, setDeck] = useState([]);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [isFlipped, setIsFlipped] = useState(false);
            const [selectedCategories, setSelectedCategories] = useState(['Kino (Z materiaÅ‚Ã³w)']);
            const [mode, setMode] = useState('standard');
            const [direction, setDirection] = useState('es_pl');
            const [inputValue, setInputValue] = useState('');
            const [feedback, setFeedback] = useState(null);

            const allCategories = Array.from(new Set(FLASHCARDS_DATA.map(c => c.category)));

            useEffect(() => {
                let filtered = FLASHCARDS_DATA.filter(c => !learnedCards.includes(c.id));
                
                if (!selectedCategories.includes('Wszystkie')) {
                    filtered = filtered.filter(c => selectedCategories.includes(c.category));
                }
                
                setDeck(filtered.sort(() => Math.random() - 0.5));
                setCurrentIndex(0);
                setIsFlipped(false);
                setFeedback(null);
                setInputValue('');
            }, [selectedCategories, learnedCards]);

            const toggleCategory = (cat) => {
                if (cat === 'Wszystkie') {
                    setSelectedCategories(['Wszystkie']);
                    return;
                }
                setSelectedCategories(prev => {
                    let newCats = prev.includes('Wszystkie') ? [] : [...prev];
                    if (newCats.includes(cat)) {
                        newCats = newCats.filter(c => c !== cat);
                    } else {
                        newCats.push(cat);
                    }
                    return newCats.length === 0 ? ['Wszystkie'] : newCats;
                });
            };

            const handleMarkLearned = () => {
                if (deck.length > 0) {
                    onMarkLearned(deck[currentIndex].id);
                }
            };

            const nextCard = () => {
                setIsFlipped(false);
                setFeedback(null);
                setInputValue('');
                setTimeout(() => setCurrentIndex((prev) => (prev + 1) % deck.length), 150);
            };

            const checkAnswer = (e) => {
                if (e) e.preventDefault();
                const current = deck[currentIndex];
                const correct = direction === 'es_pl' ? current.back : current.front;
                
                const normUser = inputValue.toLowerCase().trim();
                const normCorrect = correct.toLowerCase().trim();
                
                const isCorrect = normUser === normCorrect || (normCorrect.length > 8 && normCorrect.includes(normUser) && normUser.length > 4);

                if (isCorrect) setFeedback('correct');
                else setFeedback('incorrect');
                setIsFlipped(true); 
            };

            const insertChar = (char) => setInputValue(prev => prev + char);

            const getCategoryCount = (cat) => {
                if (cat === 'Wszystkie') {
                    return FLASHCARDS_DATA.filter(c => !learnedCards.includes(c.id)).length;
                }
                return FLASHCARDS_DATA.filter(c => c.category === cat && !learnedCards.includes(c.id)).length;
            };

            if (deck.length === 0) {
                return React.createElement('div', {className: "flex flex-col items-center justify-center h-full p-6 text-center"},
                    React.createElement(Trophy, {size: 64, className: "text-yellow-500 mb-4 animate-bounce"}),
                    React.createElement('h2', {className: "text-2xl font-bold text-white mb-2"}, "Gratulacje!"),
                    React.createElement('p', {className: "text-gray-400 mb-6"}, "PrzerobiÅ‚eÅ› wszystkie karty z wybranych kategorii."),
                    React.createElement('button', {onClick: onBack, className: "bg-gray-800 text-white px-6 py-3 rounded-xl mb-4 border border-gray-700"}, "WrÃ³Ä‡ do menu"),
                    React.createElement('div', {className: "flex flex-wrap gap-2 justify-center"},
                        allCategories.map(cat => (
                            React.createElement('button', {key: cat, onClick: () => toggleCategory(cat), className: "text-xs bg-gray-900 border border-gray-700 px-2 py-1 rounded text-gray-500"},
                                `${cat} (${getCategoryCount(cat)})`
                            )
                        ))
                    )
                );
            }

            const currentCard = deck[currentIndex];
            const frontText = direction === 'es_pl' ? currentCard.front : currentCard.back;
            const backText = direction === 'es_pl' ? currentCard.back : currentCard.front;

            return React.createElement('div', {className: "flex flex-col items-center p-4 w-full max-w-md mx-auto h-full"},
                React.createElement('div', {className: "flex justify-between w-full mb-4 items-center"},
                    React.createElement('button', {onClick: onBack, className: "text-gray-400 hover:text-white"}, React.createElement(ArrowLeft)),
                    React.createElement('div', {className: "text-center"},
                        React.createElement('h2', {className: "text-orange-500 font-bold text-xl"}, "Fiszki"),
                        React.createElement('p', {className: "text-[10px] text-gray-500"}, `Karta ${currentIndex + 1} z ${deck.length}`)
                    ),
                    React.createElement('button', {
                        onClick: onViewLearned,
                        className: "flex items-center gap-1 text-xs text-green-500 font-bold border border-green-500/30 px-2 py-1 rounded bg-green-500/10 hover:bg-green-500/20 transition",
                        title: "Zobacz nauczone"
                    }, React.createElement(Eye, {size: 12}), ` ${learnedCards.length}`)
                ),

                React.createElement('div', {className: "flex flex-wrap gap-2 w-full justify-center mb-6"},
                    React.createElement('button', {
                        onClick: () => toggleCategory('Wszystkie'),
                        className: `px-3 py-1.5 rounded-full text-xs font-bold transition border ${selectedCategories.includes('Wszystkie') ? 'bg-orange-600 text-white border-orange-500' : 'bg-gray-800 text-gray-400 border-gray-700'}`
                    }, `Wszystkie (${getCategoryCount('Wszystkie')})`),
                    allCategories.map(cat => (
                        React.createElement('button', {
                            key: cat, onClick: () => toggleCategory(cat),
                            className: `px-3 py-1.5 rounded-full text-xs font-bold transition border ${selectedCategories.includes(cat) && !selectedCategories.includes('Wszystkie') ? 'bg-orange-600 text-white border-orange-500' : 'bg-gray-800 text-gray-400 border-gray-700'}`
                        }, `${cat} (${getCategoryCount(cat)})`)
                    ))
                ),

                React.createElement('div', {className: "w-full max-w-md flex gap-2 mb-6"},
                    React.createElement('button', {
                        onClick: () => { setMode(mode === 'standard' ? 'writing' : 'standard'); setIsFlipped(false); setFeedback(null); },
                        className: "flex-1 bg-gray-900 border border-gray-800 py-2 rounded-lg text-xs font-bold text-gray-400 flex justify-center items-center gap-2 hover:bg-gray-800 transition"
                    }, mode === 'standard' ? React.createElement(Repeat, {size: 14}) : React.createElement(Keyboard, {size: 14}), mode === 'standard' ? "Tryb: Klasyczny" : "Tryb: Pisanie"),
                    React.createElement('button', {
                        onClick: () => { setDirection(direction === 'es_pl' ? 'pl_es' : 'es_pl'); setIsFlipped(false); },
                        className: "flex-1 bg-gray-900 border border-gray-800 py-2 rounded-lg text-xs font-bold text-gray-400 flex justify-center items-center gap-2 hover:bg-gray-800 transition"
                    }, React.createElement(ArrowLeftRight, {size: 14}), direction === 'es_pl' ? "ES â†’ PL" : "PL â†’ ES")
                ),

                React.createElement('div', {
                    onClick: () => mode === 'standard' && setIsFlipped(!isFlipped),
                    className: "w-full h-64 relative perspective-1000 cursor-pointer group mb-4"
                }, 
                    React.createElement('div', {
                        className: "w-full h-full transition-all duration-500 preserve-3d",
                        style: { transformStyle: 'preserve-3d', transform: isFlipped ? 'rotateY(180deg)' : 'rotateY(0deg)' }
                    },
                        // Front
                        React.createElement('div', {
                            className: "absolute w-full h-full bg-gray-800 rounded-2xl p-6 flex flex-col items-center justify-center backface-hidden border-b-4 border-orange-600 shadow-2xl",
                            style: { backfaceVisibility: 'hidden' }
                        },
                            React.createElement('span', {className: "absolute top-4 left-4 text-[10px] font-bold text-orange-500 bg-orange-900/20 px-2 py-1 rounded uppercase tracking-wider"}, currentCard.category),
                            React.createElement('h3', {className: "text-3xl font-bold text-center text-white drop-shadow-md leading-tight"}, frontText),
                            mode === 'standard' && React.createElement('p', {className: "text-xs text-gray-500 mt-6 animate-pulse"}, "(Kliknij, aby odwrÃ³ciÄ‡)")
                        ),
                        // Back
                        React.createElement('div', {
                            className: `absolute w-full h-full bg-gray-800 rounded-2xl p-6 flex flex-col items-center justify-center backface-hidden border-b-4 shadow-2xl ${feedback === 'incorrect' ? 'border-red-600' : 'border-orange-600'}`,
                            style: { backfaceVisibility: 'hidden', transform: 'rotateY(180deg)' }
                        },
                            feedback && React.createElement('div', {
                                className: `mb-4 px-3 py-1 rounded-full text-xs font-bold ${feedback === 'correct' ? 'bg-green-900/50 text-green-400' : 'bg-red-900/50 text-red-400'}`
                            }, feedback === 'correct' ? 'Åšwietnie!' : 'Prawie...'),
                            React.createElement('h3', {className: "text-2xl font-bold text-center text-orange-400 leading-tight"}, backText),
                            mode === 'writing' && feedback === 'incorrect' && React.createElement('div', {className: "mt-4 text-center"},
                                React.createElement('p', {className: "text-xs text-gray-500 uppercase"}, "Twoja odpowiedÅº:"),
                                React.createElement('p', {className: "text-red-400 line-through text-lg"}, inputValue)
                            )
                        )
                    )
                ),

                mode === 'writing' && React.createElement('div', {className: "w-full max-w-md mb-6 animate-in slide-in-from-bottom-2"},
                    !isFlipped ? (
                        React.createElement('form', {onSubmit: checkAnswer, className: "flex flex-col gap-2"},
                            React.createElement('input', {
                                type: "text",
                                value: inputValue,
                                onChange: (e) => setInputValue(e.target.value),
                                placeholder: "Wpisz tÅ‚umaczenie...",
                                className: "w-full p-4 bg-gray-900 border border-gray-700 rounded-xl text-center text-white placeholder-gray-600 focus:ring-2 focus:ring-orange-500 outline-none text-lg",
                                autoFocus: true
                            }),
                            React.createElement('div', {className: "flex justify-center gap-2"},
                                specialChars.map(char => (
                                    React.createElement('button', {
                                        type: "button", key: char, onClick: () => insertChar(char),
                                        className: "w-8 h-8 bg-gray-800 rounded text-gray-300 hover:text-white hover:bg-gray-700 text-sm font-bold border border-gray-700"
                                    }, char)
                                ))
                            ),
                            React.createElement('button', {type: "submit", className: "w-full py-3 bg-orange-600 text-white rounded-xl font-bold hover:bg-orange-500 shadow-lg mt-2 transition"}, "SprawdÅº")
                        )
                    ) : (
                        React.createElement('div', {className: "flex flex-col gap-2"},
                            feedback === 'correct' && React.createElement('button', {
                                onClick: handleMarkLearned,
                                className: "w-full py-3 bg-green-600 text-white rounded-xl font-bold hover:bg-green-500 shadow-lg flex items-center justify-center gap-2 transform active:scale-95 transition"
                            }, React.createElement(Check, {size: 20}), "Umiem to! (UsuÅ„)"),
                            React.createElement('button', {
                                onClick: nextCard,
                                className: "w-full py-3 bg-gray-800 text-white rounded-xl font-bold hover:bg-gray-700 border border-gray-700 transition"
                            }, "NastÄ™pna karta")
                        )
                    )
                ),

                mode === 'standard' && React.createElement('div', {className: "w-full max-w-md flex flex-col gap-3"},
                    React.createElement('button', {
                        onClick: handleMarkLearned,
                        className: "w-full py-4 bg-green-600 rounded-xl text-white font-bold hover:bg-green-500 shadow-lg flex items-center justify-center gap-2 transform active:scale-95 transition"
                    }, React.createElement(Check, {size: 20}), "Umiem to! (UsuÅ„ z talii)"),
                    
                    React.createElement('div', {className: "flex gap-3"},
                        React.createElement('button', {
                            onClick: () => { setIsFlipped(false); setDeck([...deck].sort(() => Math.random() - 0.5)); setCurrentIndex(0); },
                            className: "flex-1 py-3 bg-gray-800 rounded-xl text-gray-400 font-bold hover:bg-gray-700 flex justify-center items-center gap-2 border border-gray-700"
                        }, React.createElement(Shuffle, {size: 18}), "Tasuj"),
                        React.createElement('button', {
                            onClick: nextCard,
                            className: "flex-1 py-3 bg-gray-800 rounded-xl text-white font-bold hover:bg-gray-700 border border-gray-700"
                        }, "Dalej")
                    )
                )
            );
        };

        const LearnedList = ({ learnedCards, onBack, onUnlearn }) => {
            const learnedItems = FLASHCARDS_DATA.filter(c => learnedCards.includes(c.id));

            return React.createElement('div', {className: "flex flex-col h-full p-4 max-w-md mx-auto"},
                React.createElement('div', {className: "flex justify-between items-center mb-6"},
                    React.createElement('button', {onClick: onBack, className: "text-gray-400 hover:text-white flex items-center gap-1"}, React.createElement(ArrowLeft, {size: 18}), "WrÃ³Ä‡"),
                    React.createElement('span', {className: "text-green-500 font-bold"}, `Nauczone (${learnedItems.length})`),
                    React.createElement('div', {className: "w-10"})
                ),
                
                React.createElement('div', {className: "flex-1 overflow-y-auto pb-4"},
                    learnedItems.length === 0 ? (
                        React.createElement('p', {className: "text-center text-gray-500 mt-10"}, "Pusto. Zaznacz 'Umiem to!' podczas nauki.")
                    ) : (
                        React.createElement('div', {className: "space-y-2"},
                            learnedItems.map(item => (
                                React.createElement('div', {key: item.id, className: "bg-gray-900 border border-gray-800 p-4 rounded-xl flex justify-between items-center"},
                                    React.createElement('div', {},
                                        React.createElement('p', {className: "text-white font-bold"}, item.front),
                                        React.createElement('p', {className: "text-gray-400 text-sm"}, item.back)
                                    ),
                                    React.createElement('button', {onClick: () => onUnlearn(item.id), className: "p-2 bg-gray-800 text-gray-500 hover:text-white rounded-lg", title: "PrzywrÃ³Ä‡ do nauki"},
                                        React.createElement(RotateCcw, {size: 16})
                                    )
                                )
                            ))
                        )
                    )
                )
            );
        };

        const GenericQuiz = ({ title, fullData, onBack }) => {
            const [questions, setQuestions] = useState([]);
            const [current, setCurrent] = useState(0);
            const [score, setScore] = useState(0);
            const [finished, setFinished] = useState(false);
            const [feedback, setFeedback] = useState(null); // 'correct', 'wrong'
            const [selectedOption, setSelectedOption] = useState(null);
            const [userHistory, setUserHistory] = useState([]); // track { q, userChoice, isCorrect }
            const [reviewMode, setReviewMode] = useState(false);
            const [showHint, setShowHint] = useState(false);

            useEffect(() => {
                startQuiz();
            }, []);

            const startQuiz = () => {
                // Shuffle questions and options for each question
                const shuffled = [...fullData]
                    .sort(() => Math.random() - 0.5)
                    .slice(0, 10)
                    .map(q => ({
                        ...q,
                        options: shuffleArray(q.options)
                    }));
                
                setQuestions(shuffled);
                setCurrent(0);
                setScore(0);
                setFinished(false);
                setFeedback(null);
                setSelectedOption(null);
                setUserHistory([]);
                setReviewMode(false);
                setShowHint(false);
            };

            const handleAnswer = (opt) => {
                const isCorrect = opt === questions[current].correct;
                setSelectedOption(opt);
                setUserHistory([...userHistory, { 
                    question: questions[current], 
                    userChoice: opt, 
                    isCorrect 
                }]);

                if (isCorrect) {
                    setScore(score + 1);
                    setFeedback('correct');
                } else {
                    setFeedback('wrong');
                }
            };

            const nextQuestion = () => {
                setFeedback(null);
                setSelectedOption(null);
                setShowHint(false);
                if (current < questions.length - 1) {
                    setCurrent(current + 1);
                } else {
                    setFinished(true);
                }
            };

            if (questions.length === 0) return React.createElement('div', {}, "Åadowanie...");

            if (finished) {
                if (reviewMode) {
                    return React.createElement('div', {className: "flex flex-col h-full p-4 max-w-md mx-auto"},
                        React.createElement('div', {className: "flex justify-between items-center mb-6"},
                            React.createElement('button', {onClick: () => setReviewMode(false), className: "text-gray-400"}, React.createElement(ArrowLeft)),
                            React.createElement('span', {className: "text-orange-500 font-bold"}, "PrzeglÄ…d odpowiedzi"),
                            React.createElement('div', {className: "w-6"})
                        ),
                        React.createElement('div', {className: "space-y-4 overflow-y-auto pb-4"},
                            userHistory.map((item, idx) => (
                                React.createElement('div', {key: idx, className: `p-4 rounded-xl border ${item.isCorrect ? 'bg-green-900/20 border-green-800' : 'bg-red-900/20 border-red-800'}`},
                                    React.createElement('p', {className: "font-bold text-white mb-2"}, item.question.q),
                                    React.createElement('p', {className: "text-sm text-gray-400"}, "Twoja odpowiedÅº: ", 
                                        React.createElement('span', {className: item.isCorrect ? 'text-green-400' : 'text-red-400'}, item.userChoice)
                                    ),
                                    !item.isCorrect && React.createElement('p', {className: "text-sm text-gray-400"}, "Poprawna: ", 
                                        React.createElement('span', {className: "text-green-400"}, item.question.correct)
                                    )
                                )
                            ))
                        )
                    );
                }

                return React.createElement('div', {className: "flex flex-col items-center justify-center h-full p-6 text-center"},
                    React.createElement(Trophy, {size: 64, className: "text-yellow-500 mb-4"}),
                    React.createElement('h2', {className: "text-3xl font-bold text-white mb-2"}, "Koniec!"),
                    React.createElement('p', {className: "text-gray-400 mb-6"}, `TwÃ³j wynik: ${score} / ${questions.length}`),
                    React.createElement('button', {onClick: () => setReviewMode(true), className: "bg-gray-800 text-white px-6 py-3 rounded-xl border border-gray-700 w-full mb-3 flex items-center justify-center gap-2"}, React.createElement(ListChecks, {size: 18}), "Zobacz swoje odpowiedzi"),
                    React.createElement('button', {onClick: startQuiz, className: "bg-orange-600 text-white px-6 py-3 rounded-xl font-bold mb-4 w-full"}, "Zagraj ponownie (Nowe pytania)"),
                    React.createElement('button', {onClick: onBack, className: "text-gray-500 hover:text-white px-6 py-3"}, "WrÃ³Ä‡ do menu")
                );
            }

            const q = questions[current];

            return React.createElement('div', {className: "flex flex-col h-full p-4 max-w-md mx-auto"},
                React.createElement('div', {className: "flex justify-between items-center mb-6"},
                    React.createElement('button', {onClick: onBack, className: "text-gray-400"}, React.createElement(ArrowLeft)),
                    React.createElement('span', {className: "text-orange-500 font-bold"}, title),
                    React.createElement('span', {className: "text-gray-500 text-sm"}, `${current + 1}/${questions.length}`)
                ),

                React.createElement('div', {className: "flex-1 flex flex-col justify-center"},
                    React.createElement('div', {className: "relative mb-8 bg-gray-800 p-6 rounded-2xl border border-gray-700 shadow-lg text-center"},
                        React.createElement('h3', {className: "text-xl font-bold text-white"}, q.q),
                        (q.type === 'gustar' || q.type === 'normal') && React.createElement('div', {className: "absolute top-2 right-2"},
                            React.createElement('button', {
                                onClick: () => setShowHint(!showHint),
                                className: `p-1.5 rounded-full transition ${showHint ? 'bg-yellow-500/20 text-yellow-500' : 'bg-gray-700 text-gray-400 hover:text-white'}`
                            }, React.createElement(Lightbulb, {size: 16})),
                            showHint && React.createElement('span', {className: `absolute right-8 top-0 text-xs mt-2 px-2 py-1 rounded whitespace-nowrap ${q.type === 'gustar' ? 'text-blue-400 bg-blue-900/30' : 'text-green-400 bg-green-900/30'}`}, 
                                q.type === 'gustar' ? 'Czasownik GUSTAR' : 'Czasownik ZWYKÅY'
                            )
                        )
                    ),

                    React.createElement('div', {className: "space-y-3"},
                        q.options.map((opt) => {
                            let btnClass = "w-full p-4 rounded-xl text-left font-medium transition border ";
                            
                            if (feedback) {
                                if (opt === q.correct) {
                                    if (opt === selectedOption) {
                                        // Selected Correct
                                        btnClass += "bg-green-600 border-green-500 text-white shadow-lg";
                                    } else {
                                        // Not Selected Correct (Darker Green)
                                        btnClass += "bg-green-800/80 border-green-600 text-green-100 opacity-90";
                                    }
                                } else if (opt === selectedOption && opt !== q.correct) {
                                    // Selected Wrong
                                    btnClass += "bg-red-900/50 border-red-500 text-red-200 opacity-80";
                                } else {
                                    // Not Selected Wrong
                                    btnClass += "bg-gray-800 border-gray-700 text-gray-500 opacity-40";
                                }
                            } else {
                                // Default State
                                btnClass += "bg-gray-800 border-gray-700 text-white hover:bg-gray-700 hover:border-teal-500";
                            }

                            return React.createElement('button', {
                                key: opt,
                                onClick: () => !feedback && handleAnswer(opt),
                                disabled: !!feedback,
                                className: btnClass
                            }, opt)
                        })
                    )
                ),
                
                feedback && React.createElement('div', {className: "mt-4 space-y-3"},
                    React.createElement('button', {
                        onClick: nextQuestion,
                        className: "w-full py-3 bg-gray-700 hover:bg-gray-600 text-white font-bold rounded-xl border border-gray-600 transition"
                    }, "Dalej")
                )
            );
        };

        const HotelSimulator = ({ onBack }) => {
            const [current, setCurrent] = useState(0);
            const [finished, setFinished] = useState(false);
            const [feedback, setFeedback] = useState(null);
            const [userHistory, setUserHistory] = useState([]);
            const [reviewMode, setReviewMode] = useState(false);
            const [currentOptions, setCurrentOptions] = useState([]);
            const [selectedOption, setSelectedOption] = useState(null);

            const scenario = HOTEL_SCENARIOS[current];

            // Initialize shuffled options when scenario changes
            useEffect(() => {
                if (scenario) {
                    setCurrentOptions(shuffleArray(scenario.options));
                }
            }, [scenario]);

            const handleChoice = (opt) => {
                const isCorrect = opt === scenario.correct;
                setSelectedOption(opt);
                setUserHistory([...userHistory, {
                    question: scenario,
                    userChoice: opt,
                    isCorrect
                }]);
                setFeedback(isCorrect ? 'correct' : 'wrong');
            };

            const nextScenario = () => {
                setFeedback(null);
                setSelectedOption(null);
                if (current < HOTEL_SCENARIOS.length - 1) setCurrent(current + 1);
                else setFinished(true);
            };

            if (finished) {
                if (reviewMode) {
                    return React.createElement('div', {className: "flex flex-col h-full p-4 max-w-md mx-auto"},
                        React.createElement('div', {className: "flex justify-between items-center mb-6"},
                            React.createElement('button', {onClick: () => setReviewMode(false), className: "text-gray-400"}, React.createElement(ArrowLeft)),
                            React.createElement('span', {className: "text-teal-500 font-bold"}, "PrzeglÄ…d odpowiedzi"),
                            React.createElement('div', {className: "w-6"})
                        ),
                        React.createElement('div', {className: "space-y-4 overflow-y-auto pb-4"},
                            userHistory.map((item, idx) => (
                                React.createElement('div', {key: idx, className: `p-4 rounded-xl border ${item.isCorrect ? 'bg-green-900/20 border-green-800' : 'bg-red-900/20 border-red-800'}`},
                                    React.createElement('p', {className: "text-xs text-gray-500 mb-1"}, "Sytuacja:"),
                                    React.createElement('p', {className: "text-gray-300 italic mb-2"}, item.question.context),
                                    React.createElement('p', {className: "text-sm text-gray-400"}, "Twoja odpowiedÅº: ", 
                                        React.createElement('span', {className: item.isCorrect ? 'text-green-400 font-bold' : 'text-red-400 font-bold'}, item.userChoice)
                                    ),
                                    !item.isCorrect && React.createElement('p', {className: "text-sm text-gray-400"}, "Poprawna: ", 
                                        React.createElement('span', {className: "text-green-400 font-bold"}, item.question.correct)
                                    )
                                )
                            ))
                        )
                    );
                }

                return React.createElement('div', {className: "flex flex-col items-center justify-center h-full p-6 text-center"},
                    React.createElement(Hotel, {size: 64, className: "text-teal-500 mb-4"}),
                    React.createElement('h2', {className: "text-2xl font-bold text-white mb-4"}, "Symulacja ZakoÅ„czona"),
                    React.createElement('button', {onClick: () => setReviewMode(true), className: "bg-gray-800 text-white px-6 py-3 rounded-xl border border-gray-700 w-full mb-3 flex items-center justify-center gap-2"}, React.createElement(ListChecks, {size: 18}), "Zobacz swoje odpowiedzi"),
                    React.createElement('button', {onClick: onBack, className: "text-gray-500 hover:text-white px-6 py-3"}, "WrÃ³Ä‡ do menu")
                );
            }

            return React.createElement('div', {className: "flex flex-col h-full p-4 max-w-md mx-auto"},
                React.createElement('div', {className: "flex justify-between items-center mb-6"},
                    React.createElement('button', {onClick: onBack, className: "text-gray-400"}, React.createElement(ArrowLeft)),
                    React.createElement('span', {className: "text-teal-500 font-bold"}, "Symulator Hotelu")
                ),

                React.createElement('div', {className: "flex-1"},
                    React.createElement('div', {className: "bg-gray-800/50 p-4 rounded-xl mb-6 border border-teal-500/30"},
                        React.createElement('p', {className: "text-xs text-teal-400 uppercase font-bold mb-1"}, "Sytuacja:"),
                        React.createElement('p', {className: "text-gray-300 italic"}, scenario.context)
                    ),

                    scenario.receptionist && React.createElement('div', {className: "mb-4 flex flex-col items-start"},
                        React.createElement('span', {className: "text-xs text-gray-500 mb-1 ml-1"}, "Recepcja"),
                        React.createElement('div', {className: "bg-gray-700 text-white p-4 rounded-2xl rounded-tl-none max-w-[85%]"},
                            scenario.receptionist
                        )
                    ),

                    scenario.client && React.createElement('div', {className: "mb-4 flex flex-col items-end"},
                        React.createElement('span', {className: "text-xs text-gray-500 mb-1 mr-1"}, "Klient (Ty)"),
                        React.createElement('div', {className: "bg-teal-900/50 text-teal-100 p-4 rounded-2xl rounded-tr-none max-w-[85%] text-right"},
                            scenario.client
                        )
                    ),

                    React.createElement('div', {className: "space-y-3 mt-8"},
                        React.createElement('p', {className: "text-center text-sm text-gray-500 mb-2"}, "Wybierz reakcjÄ™:"),
                        currentOptions.map((opt) => {
                            let btnClass = `w-full p-4 rounded-xl text-left font-medium transition border ${
                                !feedback ? 'bg-gray-800 border-gray-700 text-white hover:bg-gray-700 hover:border-teal-500' : ''
                            }`;
                            
                            if (feedback) {
                                if (opt === scenario.correct) {
                                    if (opt === selectedOption) {
                                        // Selected Correct
                                        btnClass += "bg-green-600 border-green-500 text-white shadow-lg";
                                    } else {
                                        // Not Selected Correct (Darker Green)
                                        btnClass += "bg-green-800/80 border-green-600 text-green-100 opacity-90";
                                    }
                                } else if (opt === selectedOption && opt !== scenario.correct) {
                                    // Selected Wrong
                                    btnClass += "bg-red-900/50 border-red-500 text-red-200 opacity-80";
                                } else {
                                    // Not Selected Wrong
                                    btnClass += "bg-gray-800 border-gray-700 text-gray-500 opacity-40";
                                }
                            }

                            return React.createElement('button', {
                                key: opt,
                                onClick: () => !feedback && handleChoice(opt),
                                className: btnClass
                            }, opt)
                        })
                    ),

                    feedback && React.createElement('div', {className: "mt-4 space-y-3"},
                        React.createElement('button', {
                            onClick: nextScenario,
                            className: "w-full py-3 bg-gray-700 hover:bg-gray-600 text-white font-bold rounded-xl border border-gray-600 transition"
                        }, "Dalej")
                    )
                )
            );
        };

        const SpanishApp = () => {
            const [view, setView] = useState('menu');
            const [learnedCards, setLearnedCards] = useState(() => {
                const saved = localStorage.getItem('learnedCards');
                return saved ? JSON.parse(saved) : [];
            });

            useEffect(() => {
                localStorage.setItem('learnedCards', JSON.stringify(learnedCards));
            }, [learnedCards]);

            const handleMarkLearned = (id) => {
                setLearnedCards(prev => [...prev, id]);
            };

            const handleUnlearn = (id) => {
                setLearnedCards(prev => prev.filter(c => c !== id));
            };

            const resetLearned = () => {
                if(confirm("Czy na pewno chcesz zresetowaÄ‡ wszystkie nauczone sÅ‚Ã³wka?")) {
                    setLearnedCards([]);
                }
            };

            if (view === 'menu') {
                return React.createElement('div', {className: "min-h-screen bg-gray-950 text-white p-6 font-sans flex flex-col items-center"},
                    React.createElement('header', {className: "w-full max-w-md mb-8 mt-4 text-center"},
                        React.createElement('div', {className: "inline-block p-4 bg-gradient-to-br from-orange-600 to-red-600 rounded-full mb-4 shadow-lg shadow-orange-900/50"},
                            React.createElement(Briefcase, {size: 40, className: "text-white"})
                        ),
                        React.createElement('h1', {className: "text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-red-500 mb-2"}, "HiszpaÅ„ski: Kolokwium"),
                        React.createElement('p', {className: "text-gray-500 text-sm mb-4"}, "Wybierz tryb nauki"),
                        
                        learnedCards.length > 0 && React.createElement('div', {className: "inline-flex items-center gap-2 bg-gray-900 border border-green-900/30 px-4 py-2 rounded-full"},
                            React.createElement('span', {className: "text-green-500 font-bold text-sm"}, `Nauczono: ${learnedCards.length}`),
                            React.createElement('button', {onClick: () => setView('learned_list'), className: "text-gray-400 hover:text-white ml-2"}, React.createElement(Eye, {size: 16})),
                            React.createElement('button', {onClick: resetLearned, className: "text-gray-400 hover:text-red-400 ml-1", title: "Resetuj postÄ™p"}, React.createElement(RotateCcw, {size: 16}))
                        )
                    ),

                    React.createElement('div', {className: "w-full max-w-md grid gap-4"},
                        React.createElement('button', {onClick: () => setView('flashcards'), className: "flex items-center p-5 bg-gray-900 rounded-2xl border border-gray-800 hover:border-orange-500 transition group shadow-md transform hover:scale-[1.02]"},
                            React.createElement('div', {className: "bg-orange-900/30 p-3 rounded-xl mr-4 group-hover:bg-orange-600 group-hover:text-white text-orange-500 transition"}, React.createElement(Layers)),
                            React.createElement('div', {className: "text-left"},
                                React.createElement('h3', {className: "font-bold text-lg text-gray-200 group-hover:text-white"}, "Fiszki (SÅ‚Ã³wka)"),
                                React.createElement('p', {className: "text-xs text-gray-500"}, "Wszystkie dziaÅ‚y + Hotel + Czas wolny")
                            )
                        ),
                        React.createElement('button', {onClick: () => setView('quiz_agree'), className: "flex items-center p-5 bg-gray-900 rounded-2xl border border-gray-800 hover:border-blue-500 transition group shadow-md transform hover:scale-[1.02]"},
                            React.createElement('div', {className: "bg-blue-900/30 p-3 rounded-xl mr-4 group-hover:bg-blue-600 group-hover:text-white text-blue-500 transition"}, React.createElement(MessageCircle)),
                            React.createElement('div', {className: "text-left"},
                                React.createElement('h3', {className: "font-bold text-lg text-gray-200 group-hover:text-white"}, "Quiz: TambiÃ©n / Tampoco"),
                                React.createElement('p', {className: "text-xs text-gray-500"}, "KrÃ³tkie odpowiedzi (Zgadzanie siÄ™)")
                            )
                        ),
                        React.createElement('button', {onClick: () => setView('quiz_gustar'), className: "flex items-center p-5 bg-gray-900 rounded-2xl border border-gray-800 hover:border-pink-500 transition group shadow-md transform hover:scale-[1.02]"},
                            React.createElement('div', {className: "bg-pink-900/30 p-3 rounded-xl mr-4 group-hover:bg-pink-600 group-hover:text-white text-pink-500 transition"}, React.createElement(Heart)),
                            React.createElement('div', {className: "text-left"},
                                React.createElement('h3', {className: "font-bold text-lg text-gray-200 group-hover:text-white"}, "Quiz: Gustar & Encantar"),
                                React.createElement('p', {className: "text-xs text-gray-500"}, "Odmiana: me/te/le + gusta/an")
                            )
                        ),
                        React.createElement('button', {onClick: () => setView('hotel'), className: "flex items-center p-5 bg-gray-900 rounded-2xl border border-gray-800 hover:border-teal-500 transition group shadow-md transform hover:scale-[1.02]"},
                            React.createElement('div', {className: "bg-teal-900/30 p-3 rounded-xl mr-4 group-hover:bg-teal-600 group-hover:text-white text-teal-500 transition"}, React.createElement(Hotel)),
                            React.createElement('div', {className: "text-left"},
                                React.createElement('h3', {className: "font-bold text-lg text-gray-200 group-hover:text-white"}, "Symulator Hotelu"),
                                React.createElement('p', {className: "text-xs text-gray-500"}, "Rezerwacje i Problemy (Dialogi)")
                            )
                        ),
                        React.createElement('button', {onClick: () => setView('collocations'), className: "flex items-center p-5 bg-gray-900 rounded-2xl border border-gray-800 hover:border-yellow-500 transition group shadow-md transform hover:scale-[1.02]"},
                            React.createElement('div', {className: "bg-yellow-900/30 p-3 rounded-xl mr-4 group-hover:bg-yellow-600 group-hover:text-white text-yellow-500 transition"}, React.createElement(Check)),
                            React.createElement('div', {className: "text-left"},
                                React.createElement('h3', {className: "font-bold text-lg text-gray-200 group-hover:text-white"}, "Kolokacje (Zadanie 7)"),
                                React.createElement('p', {className: "text-xs text-gray-500"}, "Reservar, Hacer, Pedir, Salir")
                            )
                        )
                    )
                );
            }

            return React.createElement('div', {className: "min-h-screen bg-gray-950 text-white font-sans"},
                view === 'flashcards' && React.createElement(Flashcards, {onBack: () => setView('menu'), learnedCards, onMarkLearned: handleMarkLearned, onViewLearned: () => setView('learned_list'), onUnlearn: handleUnlearn}),
                view === 'learned_list' && React.createElement(LearnedList, {onBack: () => setView('menu'), learnedCards, onUnlearn: handleUnlearn}),
                view === 'quiz_agree' && React.createElement(GenericQuiz, {title: "Quiz: TambiÃ©n / Tampoco", fullData: QUIZ_AGREEMENT_DATA_FULL, onBack: () => setView('menu')}),
                view === 'quiz_gustar' && React.createElement(GenericQuiz, {title: "Quiz: Gustar", fullData: QUIZ_GUSTAR_DATA_FULL, onBack: () => setView('menu')}),
                view === 'collocations' && React.createElement(GenericQuiz, {title: "Kolokacje (ABC)", fullData: QUIZ_COLLOCATIONS_DATA, onBack: () => setView('menu')}),
                view === 'hotel' && React.createElement(HotelSimulator, {onBack: () => setView('menu')})
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(SpanishApp));
    </script>
</body>
</html>
